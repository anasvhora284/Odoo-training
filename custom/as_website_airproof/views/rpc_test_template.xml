<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="rpc_test_template" name="RPC Test Page">
        <t t-call="website.layout">
            <div id="rpc-test" class="container my-5">
                <div class="row">
                    <div class="col-lg-12">
                        <h1 class="mb-4">Odoo RPC Test Page</h1>
                        <p class="lead">
                            This page demonstrates RPC functionality in Odoo 18.0.
                        </p>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-lg-6">
                        <div class="card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h3 class="card-title mb-0">XML-RPC Test</h3>
                            </div>
                            <div class="card-body">
                                <p>
                                    XML-RPC is a remote procedure call protocol which uses XML to encode its calls and HTTP as a transport mechanism.
                                </p>
                                <pre class="bg-light p-3 rounded">
                                    <code>
import xmlrpc.client

# Define connection parameters
url = 'http://localhost:8069'
db = 'theme_try'
username = 'admin'
password = 'admin'

# Authentication
common = xmlrpc.client.ServerProxy(f'{url}/xmlrpc/2/common')
uid = common.authenticate(db, username, password, {})

# Call methods
models = xmlrpc.client.ServerProxy(f'{url}/xmlrpc/2/object')
result = models.execute_kw(
    db, uid, password,
    'as_website_airproof.rpc_log', 
    'perform_calculation', 
    [[10, 5, 'add']]
)
print(result)
                                    </code>
                                </pre>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="card mb-4">
                            <div class="card-header bg-success text-white">
                                <h3 class="card-title mb-0">JSON-RPC Test</h3>
                            </div>
                            <div class="card-body">
                                <p>
                                    JSON-RPC is a remote procedure call protocol encoded in JSON. It is a very simple protocol.
                                </p>
                                <pre class="bg-light p-3 rounded">
                                    <code>
import requests
import json

# Define connection parameters
url = 'http://localhost:8069'
db = 'theme_try'
username = 'admin'
password = 'admin'

# Authentication
headers = {'Content-Type': 'application/json'}
data = {
    'jsonrpc': '2.0',
    'method': 'call',
    'params': {
        'service': 'common',
        'method': 'authenticate',
        'args': [db, username, password, {}]
    },
    'id': 1
}
response = requests.post(
    f'{url}/jsonrpc', data=json.dumps(data), headers=headers
)
uid = response.json()['result']

# Call methods
data = {
    'jsonrpc': '2.0',
    'method': 'call',
    'params': {
        'model': 'as_website_airproof.rpc_log',
        'method': 'perform_calculation',
        'args': [10, 5, 'add'],
        'kwargs': {}
    },
    'id': 2
}
response = requests.post(
    f'{url}/web/dataset/call_kw', data=json.dumps(data), headers=headers, cookies=response.cookies
)
print(response.json()['result'])
                                    </code>
                                </pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header bg-info text-white">
                                <h3 class="card-title mb-0">Live Calculator Demo</h3>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="first_number">First Number</label>
                                            <input type="number" class="form-control" id="first_number" value="10" />
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="operation">Operation</label>
                                            <select class="form-control" id="operation">
                                                <option value="add">Addition (+)</option>
                                                <option value="subtract">Subtraction (-)</option>
                                                <option value="multiply">Multiplication (*)</option>
                                                <option value="divide">Division (/)</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="second_number">Second Number</label>
                                            <input type="number" class="form-control" id="second_number" value="5" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-8">
                                        <button id="calculate" class="btn btn-primary">Calculate</button>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="result-box p-3 bg-light border rounded">
                                            Result: <span id="result">?</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script type="text/javascript">
                document.addEventListener('DOMContentLoaded', function() {
                    document.getElementById('calculate').addEventListener('click', function() {
                        // Get values
                        var firstNumber = parseFloat(document.getElementById('first_number').value || 0);
                        var secondNumber = parseFloat(document.getElementById('second_number').value || 0);
                        var operation = document.getElementById('operation').value;
                        
                        // Call the RPC endpoint
                        odoo.jsonRpc("/airproof/rpc/calculator", 'call', {
                            'first_number': firstNumber,
                            'second_number': secondNumber,
                            'operation': operation
                        }).then(function(data) {
                            if (data.success) {
                                document.getElementById('result').innerText = data.result;
                            } else {
                                document.getElementById('result').innerText = 'Error: ' + data.error;
                            }
                        }).catch(function(error) {
                            document.getElementById('result').innerText = 'Error: ' + error.message;
                        });
                    });
                });
            </script>
        </t>
    </template>
</odoo> 